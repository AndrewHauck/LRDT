this is thomas' forked master branch